<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¼˜48 - ç¬¬ä¸€å¤©å‰§æƒ…</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯æŒ‰é’® -->
    <div id="mobile-info-btn" style="position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #667eea; color: white; border: none; font-size: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); z-index: 1000; cursor: pointer; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>

    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿ -->
    <div id="mobile-info-panel" style="display: none; position: fixed; bottom: 80px; right: 20px; width: 250px; max-height: 300px; background: rgba(255, 255, 255, 0.98); border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); z-index: 1000; padding: 15px; overflow-y: auto;">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€å¡«å…… -->
    </div>

    <!-- é®ç½©å±‚ -->
    <div id="mobile-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

    <!-- å‰§æƒ…å†…å®¹åŒºåŸŸ -->
    <div id="scene-content">
        <div class="page-container">
            <h2>ç¬¬ä¸€å¤© - ç‹å®«å¤§æ®¿</h2>

            <div class="scene-content">
                <div class="dialogue-section">
                    <div class="character-portrait king">
                        <div class="portrait-circle">ğŸ‘‘</div>
                        <div class="character-name">å…‹åŠ³ç‹„æ–¯</div>
                    </div>

                    <div class="dialogue-bubble king-bubble">
                        <p>"è¯¸ä½ï¼"</p>
                        <p>ä¸¹éº¦ç‹çš„å£°éŸ³ç©¿é€ç©ºæ°”ï¼Œç›´ä¸Šä¸‰æ¥¼ã€‚</p>
                        <p>"çš‡å®«çš„ä¿®å»ºäº‹å…³å›½å®¶é¢œé¢ï¼Œå®¹ä¸å¾—åŠç‚¹é—ªå¤±ï¼æ˜¨å¤©ç«Ÿç„¶åœ¨æ–½å·¥ç°åœºå‘ç°ä¸€å…·æ— åå°¸ä½“ï¼Œè¿™ç®€ç›´æ˜¯å¥‡è€»å¤§è¾±ï¼"</p>
                        <p>"æœ•å‘½ä»¤æ‰€æœ‰äººæ‰¾å‡ºå…ƒå‡¶ï¼Œç¬¬ä¸€ä¸ªæŸ¥æ¸…è€…æœ‰é‡èµã€‚"</p>
                        <p>"å‘ç°å°¸ä½“å¤„å°èµ·æ¥ä¿æŠ¤ç°åœºï¼Œé—²æ‚äººç­‰ä¸å¾—å…¥å†…ã€‚"</p>
                    </div>
                </div>

                <div class="narrative-text">
                    <p>æ¼”è®²å®Œæ¯•ï¼Œå…¨åœºå®‰é™äº†ç‰‡åˆ»ã€‚çªç„¶ï¼Œä¸€ä¸ªèº«å½±ä»ä¼—äººä¸­ç«™äº†å‡ºæ¥ã€‚</p>
                </div>

                <div class="dialogue-section">
                    <div class="character-portrait hefei">
                        <div class="portrait-circle">ğŸ­</div>
                        <div class="character-name">ä½•é</div>
                    </div>

                    <div class="dialogue-bubble hefei-bubble">
                        <p>"é™›ä¸‹ï¼Œæˆ‘æœ‰ä¸€ä¸ªåŠæ³•ï¼"</p>
                    </div>
                </div>

                <div class="dialogue-section">
                    <div class="character-portrait king">
                        <div class="portrait-circle">ğŸ‘‘</div>
                        <div class="character-name">å…‹åŠ³ç‹„æ–¯</div>
                    </div>

                    <div class="dialogue-bubble king-bubble">
                        <p>"å“¦ï¼Ÿä½•éï¼Œä½ æœ‰ä»€ä¹ˆå¥½åŠæ³•ï¼Ÿå¿«è¯´ï¼"</p>
                        <p>å›½ç‹æ€¥åˆ‡åœ°é—®é“ã€‚</p>
                    </div>
                </div>

                <div class="dialogue-section">
                    <div class="character-portrait hefei">
                        <div class="portrait-circle">ğŸ­</div>
                        <div class="character-name">ä½•é</div>
                    </div>

                    <div class="dialogue-bubble hefei-bubble">
                        <p>"é™›ä¸‹ï¼Œæ˜å¤©è¿™æ—¶å€™ï¼Œè¯·æ‚¨å’Œè¯¸ä½å¤§è‡£åˆ°ä¸Šæµ·æ–‡åŒ–å¹¿åœºæ¥çœ‹ä¸€åœºæˆã€‚"</p>
                        <p>"è¿™åœºæˆä¼šå‘Šè¯‰å¤§å®¶ï¼Œå°¸ä½“ç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹ã€‚"</p>
                        <p>ä½•éå–äº†ä¸ªå…³å­ï¼Œç¥ç§˜åœ°ç¬‘äº†ç¬‘ã€‚</p>
                    </div>
                </div>

                <div class="narrative-text">
                    <p>ä¸¹éº¦ç‹æ€è€ƒç‰‡åˆ»ï¼Œç‚¹äº†ç‚¹å¤´ï¼š"å¥½ï¼Œå°±ä¾ä½ æ‰€è¨€ã€‚æ˜å¤©æˆ‘ä»¬å‡†æ—¶å‰å¾€ï¼"</p>
                    <p>ä¼—äººé¢é¢ç›¸è§‘ï¼Œä¸çŸ¥é“ä½•éè‘«èŠ¦é‡Œå–çš„æ˜¯ä»€ä¹ˆè¯ã€‚</p>
                </div>

                <div class="scene-actions">
                    <button class="action-btn primary large" onclick="proceedToInnerThoughts()">
                        ç»§ç»­
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="assets/js/characters.js"></script>
    <script src="assets/js/items.js"></script>
    <script src="assets/js/itemStories.js"></script>
    <script>
        // ä»URLå‚æ•°è·å–è§’è‰²ä¿¡æ¯
        const urlParams = new URLSearchParams(window.location.search);
        const selectedCharacter = urlParams.get('character') || 'claudius';

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            selectedCharacter: selectedCharacter,
            currentDay: 1,
            gameStarted: true,
            playerInventory: [],
            allCharactersItems: {},
            npcs: []
        };

        // åˆå§‹åŒ–è§’è‰²è£…å¤‡ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function initCharacterData() {
            const char = window.characters[selectedCharacter];
            gameState.playerInventory = [...char.initialItems];
            updateMobileInfoPanel();
        }

        // æ›´æ–°ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function updateMobileInfoPanel() {
            const isMobile = window.innerWidth <= 768;

            // æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.style.display = (isMobile && gameState.gameStarted) ? 'flex' : 'none';
            }

            if (!isMobile || !gameState.gameStarted) {
                hideMobileInfoPanel();
                return;
            }

            const char = window.characters[gameState.selectedCharacter];
            const panel = document.getElementById('mobile-info-panel');

            if (panel) {
                panel.innerHTML = `
                    <div class="character-info">
                        <strong>è§’è‰²ï¼š</strong>
                        <span>${char.name}</span><br>
                        <small style="color: #666;">${char.title}</small>
                    </div>

                    <h4>ğŸ“¦ èƒŒåŒ…</h4>
                    <div id="mobile-inventory">
                        ${gameState.playerInventory.length === 0 ?
                            '<div style="color: #999; font-style: italic;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                            gameState.playerInventory.map(item =>
                                `<div style="padding: 8px; margin: 5px 0; background: #f5f5f5; border-radius: 5px;">${getItemDisplayName(item)}</div>`
                            ).join('')
                        }
                    </div>

                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <strong>ç¬¬ ${gameState.currentDay} å¤©</strong>
                    </div>
                `;
            }
        }

        // åˆ‡æ¢ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function toggleMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            if (panel) {
                const isVisible = panel.style.display === 'block';
                if (isVisible) {
                    hideMobileInfoPanel();
                } else {
                    showMobileInfoPanel();
                }
            }
        }

        // æ˜¾ç¤ºç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function showMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'block';
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        // éšè—ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function hideMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'none';
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // ç»§ç»­åˆ°å†…å¿ƒç‹¬ç™½
        function proceedToInnerThoughts() {
            window.location.href = `day1-inner-thoughts.html?character=${selectedCharacter}`;
        }

        // äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            initCharacterData();

            // ç§»åŠ¨ç«¯æŒ‰é’®äº‹ä»¶
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', toggleMobileInfoPanel);
            }

            // é®ç½©å±‚ç‚¹å‡»å…³é—­
            document.addEventListener('click', function(e) {
                if (e.target.id === 'mobile-overlay') {
                    hideMobileInfoPanel();
                }
            });

            // ESCé”®å…³é—­
            document.addEventListener('keydown', function(e) {
                if (e.keyCode === 27) {
                    hideMobileInfoPanel();
                }
            });
        });
    </script>
</body>
</html>