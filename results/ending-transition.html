<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’Ÿå£°å“èµ·</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯æŒ‰é’® -->
    <div id="mobile-info-btn" style="position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #667eea; color: white; border: none; font-size: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); z-index: 1000; cursor: pointer; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>

    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿ -->
    <div id="mobile-info-panel" style="display: none; position: fixed; bottom: 80px; right: 20px; width: 250px; max-height: 300px; background: rgba(255, 255, 255, 0.98); border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); z-index: 1000; padding: 15px; overflow-y: auto;">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€å¡«å…… -->
    </div>

    <!-- ç”µè„‘ç«¯ä¾§è¾¹æ  -->
    <div id="desktop-sidebar" style="display: none; position: fixed; top: 80px; right: 20px; width: 280px; max-height: 80vh; background: rgba(255, 255, 255, 0.95); border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); z-index: 1000; padding: 20px; overflow-y: auto; border: 1px solid #e0e0e0;">
        <h4 style="margin: 0 0 15px 0; color: #667eea; border-bottom: 2px solid #667eea; padding-bottom: 8px;">è§’è‰²ä¿¡æ¯</h4>
        <div id="desktop-sidebar-content">
            <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€å¡«å…… -->
        </div>
    </div>

    <!-- é®ç½©å±‚ -->
    <div id="mobile-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

    <!-- ç”µè„‘ç«¯ä¿¡æ¯æŒ‰é’® -->
    <div id="desktop-info-btn" style="position: fixed; top: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #667eea; color: white; border: none; font-size: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); z-index: 1001; cursor: pointer; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>

    <!-- ç»“å±€è¿‡æ¸¡å†…å®¹ -->
    <div id="ending-transition-content">
        <div class="page-container">
            <h2>ç¬¬6ç«  - é’Ÿå£°å“èµ·</h2>

            <div class="story-container">
                <div class="story-header">
                    <div class="day-indicator">
                        <span class="day-number">ç¬¬ 3 å¤©</span>
                        <span class="story-title">æœ€ç»ˆæ—¶åˆ»</span>
                    </div>
                </div>
            </div>

            <div class="dialogue-container">
                <div class="dialogue-scene">
                    <p id="ending-content-text">ç»“å±€å†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º</p>
                </div>

                <div class="dialogue-actions">
                    <button class="action-btn primary large" onclick="goToSettlement()">
                        ç»§ç»­
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="../assets/js/characters.js"></script>
    <script src="../assets/js/items.js"></script>
    <script src="../assets/js/itemStories.js"></script>
    <script src="../assets/js/backpack-improvements.js"></script>
    <script src="../assets/js/item-details.js"></script>
    <script>
        // ä»URLå‚æ•°è·å–ä¿¡æ¯
        const urlParams = new URLSearchParams(window.location.search);
        const currentCharacter = urlParams.get('character') || 'claudius';
        const endingId = urlParams.get('endingId') || '';
        
        // ä»localStorageè·å–æ¸¸æˆçŠ¶æ€
        const savedState = localStorage.getItem('qiyuanGameState');
        const gameState = savedState ? JSON.parse(savedState) : {
            selectedCharacter: currentCharacter,
            currentDay: 5,
            gameStarted: true,
            playerInventory: [],
            allCharactersItems: {},
            npcs: []
        };
        
        // ç»“å±€å†…å®¹æ˜ å°„
        const endingContents = {
            'general-failure-code': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'ä½ è¾¾æˆäº†: 404 not found',
                specialContent: 'ä½ æ‰“å¼€åŒ…ï¼Œä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œé‚£è¡Œä»£ç çœŸçš„çƒ«çƒ«çƒ«çƒ«çƒ«ï¼Œå®ƒç»™ä½ çš„åŒ…çƒ«äº†ä¸€ä¸ªæ´ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½æ¼å‡ºå»äº†ã€‚'
            },
            'claudius-success-clothes': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'åŸæ¥ææƒ³æ˜¯å“ˆå§†é›·ç‰¹æ˜“å®¹çš„ï¼Œç©¿ç¾½ç»’æœæ˜¯å› ä¸ºè¦åˆ°è‹±æ ¼å…°å»ã€‚',
                specialContent: 'ä¸€å®šæœ‰ä»€ä¹ˆä¸ç¬¦åˆå¸¸ç†çš„ã€‚ç­‰ç­‰ï¼Œææƒ³é‚£å°å­ä¸æ˜¯æ¯å¤©ç©¿é£è¡£å—ï¼Œä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šç¾½ç»’æœï¼Ÿ'
            },
            'claudius-success-notes': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ é¡ºç€æ‰‹è®°æ‰¾åˆ°äº†ç¯¡ä½çš„è¯æ®ï¼Œå¹¶ä¸”å·å·é”€æ¯äº†å®ƒã€‚è‡³äºå´æ™ºå“²é‚£ä¸ªå‚»å°å­ï¼Œå‘µã€‚',
                specialContent: 'è€å»ºç­‘å­¦å®¶ä¸€è¾ˆå­æœ‰å¾ˆå¤šç ”ç©¶ï¼Œè¦ä¸å…ˆçœ‹ä¸€ä¸‹æ‰‹è®°é‡Œæœ‰ä»€ä¹ˆã€‚ä¸å¯¹ï¼Œè¿™ä¸ªè®°å·æ€ä¹ˆå’Œä½ çš„çº¹èº«è¿™ä¹ˆç›¸ä¼¼ï¼Ÿ'
            },
            'claudius-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'æ²¡æƒ³åˆ°ä½ æ²¡èƒ½ç­‰åˆ°å‡¶æ€æ¡ˆçš„çº¿ç´¢ï¼Œç¨‹å©´è”åˆå´æ™ºå“²å´å‘ç°äº†ä½ å½“å¹´ç¯¡ä½çš„è¯æ®å¹¶å…¬ä¹‹äºä¼—ã€‚å¤©ä¸‹çš†æƒŠç«Ÿæœ‰äººä¸ºäº†çš‡ä½å¼„æ­»è‡ªå·±çš„å…„é•¿ï¼Œä½ è¢«æ„¤æ€’çš„äººä»¬å¤„æ­»äº†ã€‚',
                specialContent: 'èƒŒåŒ…é‡Œå¥½åƒæ²¡æœ‰ä»€ä¹ˆæŒ‡å‘ä½ å½“å¹´è°‹åçš„è¯æ®ã€‚ä½ ç«™èµ·æ¥ï¼Œå››å¤„æ­»ä¸€æ ·å¯‚é™æ²¡æœ‰å›å£°ã€‚å¤©å ‚åœ¨æ²‰é»˜ï¼Œä½ å¦‚ä½•ç¥·å‘Šã€‚'
            },
            'chengying-success-diving': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'æ²¡æƒ³åˆ°å…‹åŠ³ç‹„æ–¯è°‹åçš„è¯æ®è¿˜çœŸçš„åœ¨ä¸‹æ°´é“çš„æ§åˆ¶å®¤åçš„æš—å®¤é‡Œã€‚ä¸‹æ°´é“è™½çª„ï¼Œä½ çš„ä¹‰ä¸¾çŠ¹å¦‚ä¸€äººæ¸¡è¿‡äº†ä¸ƒæ¡å¤§æ²³ã€‚',
                specialContent: 'ä½ çœ‹ç€èƒŒåŒ…ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆç›´æ¥è¯æ®ï¼Œæ‰“ç®—æ­»é©¬å½“æ´»é©¬åŒ»äº†ã€‚äºæ˜¯ä½ ä¸é¡¾å¯’å†·ï¼Œç©¿ç€æ½œæ°´æœè·³è¿›ä¸‹æ°´é“ã€‚'
            },
            'chengying-success-notes': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ æ‰¾åˆ°å´æ™ºå“²ï¼ŒæŠŠçŸ¥é“çš„ä¸€åˆ‡å‘Šè¯‰äº†ä»–ã€‚å´æ™ºå“²æ— è°“ï¼Œä¸æ€•å†¬å¤©çš„ä¸‹æ°´é“æœ‰å¤šå†·ï¼Œè·³ä¸‹å»æ‰¾åˆ°äº†å…‹åŠ³ç‹„æ–¯è°‹åçš„è¯æ®ã€‚',
                specialContent: 'ä½ ä»”ç»†è¾¨è®¤å´æ™ºå“²è€å¸ˆçš„æ‰‹ç¨¿ï¼Œçœ‹åˆ°äº†é‚£ä¸ªæ°´æµçš„æ ‡è®°ã€‚è¿™ä¸ªæ ‡è®°å¥½åƒåœ¨å“ªé‡Œè§è¿‡ï¼Ÿå¯¹äº†ï¼Œè¿™æ˜¯å…‹åŠ³ç‹„æ–¯çš„çº¹èº«ï¼Œä½ ä¸ºä»–æŠŠè„‰æ—¶çœ‹åˆ°è¿‡ã€‚è¿™è¯´æ˜è¿™ä¸ªæ ‡è®°çš„åœ°æ–¹åº”è¯¥å°±æ˜¯æœ‰å’Œå…‹åŠ³ç‹„æ–¯çš„ç§˜å¯†æœ‰å…³ï¼'
            },
            'chengying-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¾ˆä¸å¹¸ï¼Œä½ æ²¡æœ‰æ‰¾åˆ°å…‹åŠ³ç‹„æ–¯è°‹åçš„è¯æ®ã€‚ä¼—äººä¹Ÿæ²¡æœ‰æ‰¾åˆ°å‡¶æ€æ¡ˆçš„çœŸå‡¶ã€‚',
                specialContent: 'æ‰‹ä¸Šçš„è¿™äº›ä¸œè¥¿å¥½åƒä¸èƒ½è¯æ˜å…‹åŠ³ç‹„æ–¯è°‹åã€‚è¦ä¸å…ˆçœ‹çœ‹å¤§å®¶å¯¹å‡¶æ€æ¡ˆæœ‰æ²¡æœ‰çœ‰ç›®å§ã€‚'
            },
            'hefei-success-report': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ ç¼–é€ äº†ä¸€ä¸ªæ•…äº‹ï¼Œè¯´æ˜¯ææƒ³çš„è®¾è®¡æœ‰é—®é¢˜ç‹å«å›½ä»–ä»¬æ›¿ä»–é®æ©äº†ï¼ŒæˆåŠŸå«ç¥¸ææƒ³å’Œç‹å«å›½ã€‚å…‹åŠ³ç‹„æ–¯å› æ­¤ç»™ä½ äº†ä¸€ç¬”é’±ã€‚',
                specialContent: 'ä½ çœ‹ç€å‘¨æŠ¥ï¼Œæ•é”åœ°å‘ç°ä¸Šé¢çš„è€ƒå‹¤è®°å½•æœ‰è¯·å‡ã€‚è¿è¾“è½¦æ¬¡å› æ­¤ä¹Ÿå‡å°‘äº†ã€‚è½¦çš„å®¹é‡æ˜¯ä¸€å®šçš„ï¼Œè¿è¾“æ¬¡æ•°å°‘äº†ä¸æ­£è¯´æ˜ææ–™è¿è¾“æ•°é‡å‡å°‘äº†å—ï¼Ÿ'
            },
            'hefei-success-pass': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ç‹å«å›½çš„å›¢é˜Ÿä¸æ˜¯å¡ä½æ— æ³•æ–½å·¥äº†å—ï¼Ÿç°åœ¨è‚¯å®šå¾ˆéœ€è¦é€šå…³ä»¤ç‰Œã€‚ä½ æŠŠå®ƒå–ç»™ç‹å«å›½ï¼Œè®©æ–½å·¥é˜Ÿå¯ä»¥ç»§ç»­æ–½å·¥ä¸å—æ¡ˆæƒ…å½±å“ã€‚ä»–ç»™äº†ä½ ä¸€å¤§ç¬”ï¼Œä½ è¿˜æ¸…äº†èµŒå€ºã€‚',
                specialContent: 'èƒŒåŒ…é‡Œçš„ä¸œè¥¿å¥½åƒæ²¡ä»€ä¹ˆç”¨å•Šâ€¦æ­»è„‘å­å¿«æƒ³å•Šï¼Œä½ å¯æ˜¯å ‚å ‚æ±Ÿæ¹–ç™¾æ™“ç”Ÿã€‚å¯¹äº†ï¼Œé€šå…³ä»¤ç‰Œï¼è¿™å¯æ˜¯å»ä»»ä½•åœ°æ–¹çš„ä¸‡èƒ½é€šè¡Œè¯ï¼ä½ çš„è„‘å­é‡Œæœ‰äº†ä¸€ä¸ªä¸»æ„ã€‚'
            },
            'hefei-failure-flashlight': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¾ˆä¸å¹¸å¤§å®¶éƒ½æ²¡æœ‰å¤´ç»ªã€‚å…‹åŠ³ç‹„æ–¯é—®ï¼Œä½ ä¸æ˜¯è¦è®©ä»–çœ¼å‰ä¸€äº®å—ï¼Ÿä½ æ‰“å¼€äº†æ‰‹ç”µç­’ã€‚',
                specialContent: 'èƒŒåŒ…é‡Œçš„ä¸œè¥¿å¥½åƒæ²¡å•¥ç”¨å•Šï¼Œè¦ä¸å…ˆæ‹¿ç€å»åŠ å…‹åŠ³ç‹„æ–¯è§æ‹›æ‹†æ‹›å§ï¼Œä¸‡ä¸€å…¶ä»–äººæ‰¾åˆ°çº¿ç´¢äº†å‘¢ï¼Ÿ'
            },
            'hefei-failure-crown': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¯æ¶å…‹åŠ³ç‹„æ–¯ç«Ÿç„¶ç»™çç ä¸‹æ¯’ï¼Œä½ è¢«æ¯’æ­»äº†ã€‚',
                specialContent: 'ä¸å…‰å‡¶æ€æ¡ˆæ²¡æœ‰çœ‰ç›®ï¼ŒèµŒå€ºè¦åˆ°æœŸäº†ã€‚ä¸ç®¡äº†ï¼Œä½ å†³å®šå…ˆè¿˜ä¸ŠèµŒå€ºã€‚ä»€ä¹ˆä¸œè¥¿å€¼é’±å‘¢ï¼Ÿä½ æŠŠç›®å…‰ç§»å‘äº†æƒæ–ä¸Šçš„çç ï¼Œè¿™ä¹ˆå¤§è‚¯å®šå¾ˆå€¼é’±å§ã€‚è¿™ç©æ„å„¿æ²¡æœ‰å·¥å…·å¯çœŸéš¾æŠ ä¸‹æ¥å•Šï¼Œä½ æ€¥å¾—ä¸Šå˜´å’¬å®ƒã€‚'
            },
            'hefei-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¾ˆä¸å¹¸æ‰€æœ‰äººéƒ½æ²¡æœ‰æ‰¾åˆ°å…ƒå‡¶ï¼Œå…‹åŠ³ç‹„æ–¯å¤§æ€’è§‰å¾—ä½ è€ä»–ï¼ŒæŠŠä½ å¤„æ­»äº†ã€‚',
                specialContent: 'ä½ çœ‹ç€èƒŒåŒ…é‡Œçš„ä¸œè¥¿ï¼Œä»·å€¼çš„é’±ä¸å¤Ÿæ¢èµŒå€ºçš„ã€‚ä½ æ„çœ‰è‹¦è„¸åœ°ç›˜ç®—åº”è¯¥æ€ä¹ˆåŠï¼Œå‡¶æ€æ¡ˆä¹ŸæŠ›åœ¨ä¸€è¾¹äº†ã€‚'
            },
            'lixiang-success-pill': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ æ‰¾åˆ°ç‹å®«çš„é‡Œçš„ä¾å«è¯å®äº†å½“æ™šä¸‹æš´é›¨çš„äº‹å®ï¼Œè¿™æ°å¥½è¯æ˜ä¸‹æ°´é“ç³»ç»Ÿæ’æ°´å¾ˆå¥½æ‰€ä»¥ç¬¬äºŒå¤©æ²¡æœ‰çœ‹åˆ°æ°´ã€‚è‡³äºå°¸ä½“ï¼Œä¸æ˜¯æ·¹æ­»çš„ï¼Œè¯´æ˜å’Œä¸‹æ°´é“è®¾è®¡æ— å…³ã€‚',
                specialContent: 'ç­‰ç­‰ï¼Œå®‰çœ è¯ã€‚ä½ æ‹¿ç€å®‰çœ è¯å»æ‰¾äº†ç¨‹å©´ï¼Œå‘Šè¯‰ä»–ä½ å·²ç»çŸ¥é“äº†ä»–çš„ç§˜å¯†ï¼Œè®©ä»–ç»™ä½ ä¸€äº›ä¿¡æ¯ä½œäº¤æ¢ã€‚ä»–ç¡®å®ä¸çŸ¥é“å‡¶æ‰‹æ˜¯è°ï¼Œä½†æ˜¯äº‹å‘å‰ä¸€å¤œæ²¡ç¡ï¼ŒçŸ¥é“å½“æ—¶çš‡å®«ä¸Šå¤©é™æš´é›¨ï¼Œè€Œç¬¬äºŒå¤©å…‹åŠ³ç‹„æ–¯å¬é›†ä½ ä»¬çš„æ—¶å€™åœ°é¢æ˜¯å¹²çš„ã€‚'
            },
            'lixiang-success-report': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ æ‹¿ç€ç‹å«å›½çš„å‘¨æŠ¥è¯æ˜äº†è‡ªå·±çš„å·¥ä½œã€‚è‡³äºå°¸ä½“ï¼Œä¸æ˜¯æ·¹æ­»çš„ï¼Œè¯´æ˜å’Œä¸‹æ°´é“è®¾è®¡æ— å…³ã€‚',
                specialContent: 'ç‹å«å›½çš„å‘¨æŠ¥é‡Œè®°å½•äº†æ¯å‘¨çš„å·¥ä½œã€‚ä¸Šé¢è®°å½•äº†æœ‰ä¸€å¤©åˆåå¤§æš´é›¨ï¼Œä¸‹åˆä¸Šç­çš„æ—¶å€™æ°´å·²ç»æ’å¹²äº†æ²¡æœ‰ç§¯æ°´ã€‚é‚£å¤ªå¥½ä¸è¿‡äº†ï¼Œè¿™è¯´æ˜ä¸‹æ°´é“ç³»ç»Ÿçš„åŠŸèƒ½æ˜¯å®Œå–„çš„ï¼'
            },
            'lixiang-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¤§å®¶éƒ½æ²¡æœ‰æ‰¾åˆ°è¯æ®ã€‚ä½•éä¸ºäº†è¯æ˜è‡ªå·±æ˜¨å¤©çš„æˆæ˜¯æœ‰æ„ä¹‰çš„ï¼Œç¼–é€ äº†ä¸€ä¸ªæ•…äº‹ï¼Œè¯´ä¸‹æ°´é“è®¾è®¡ä¸åˆç†å¯¼è‡´é‡Œé¢å¸¸å¹´æœ‰è›‡ï¼Œæ­»è€…æ˜¯è¢«å“æ­»çš„ï¼Œè®©å…‹åŠ³ç‹„æ–¯æŠŠä½ å¤„æ­»äº†ã€‚',
                specialContent: 'ä½ çœ‹äº†çœ‹ï¼Œæ‰‹ä¸Šçš„è¯æ®å¥½åƒä¸è¶³å•Š...å…¶ä»–äººæ‰‹ä¸Šçš„è¯æ®æœ‰ä»€ä¹ˆå¯ä»¥åæ¨ä½ çš„å·¥ä½œçš„å—ï¼Ÿ'
            },
            'wangweiguo-success-pass': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'é˜Ÿå‹ä»¬æ‹¿ç€ä½ ç»™çš„é€šå…³ä»¤ç‰Œï¼Œæœç„¶å¯ä»¥ç»§ç»­æ–½å·¥äº†ï¼ä½ ä»¬æˆåŠŸå®Œå·¥ï¼Œå›å®¶è¿‡äº†ä¸€ä¸ªå¥½å¹´ã€‚è‡³äºå‡¶æ€æ¡ˆï¼Œå¬è¯´å…‹åŠ³ç‹„æ–¯æ‰¾åˆ°äº†å…ƒå‡¶ã€‚',
                specialContent: 'è¿™æ˜¯ä»€ä¹ˆï¼Ÿé€šå…³ä»¤ç‰Œï¼ä½ è¯•æ¢ç€æ‹¿ç€é€šå…³ä»¤ç‰Œèµ°è¿‡è¢«æ‹¦èµ·æ¥çš„åŒºåŸŸï¼Œä¾å«ä»¬æ²¡æœ‰é˜»æ‹¦ã€‚å¤ªå¥½äº†ï¼Œè¿™æ˜¯ä¸æ˜¯æ„å‘³ç€å·¥ç¨‹é˜Ÿå¯ä»¥æ‹¿ç€è¿™ä¸ªä»¤ç‰Œä¹Ÿé€šè¿‡è¢«æ‹¦èµ·æ¥çš„å¿…ç»ä¹‹è·¯ã€‚'
            },
            'wangweiguo-success-blueprint': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ æ‹¿ç€ä¸‹æ°´é“å›¾çº¸è®©å…„å¼Ÿä»¬é¡ºåˆ©ç»§ç»­æ–½å·¥ï¼ŒæˆåŠŸç»“ç®—å›å®¶è¿‡äº†ä¸€ä¸ªå¥½å¹´ã€‚è‡³äºå‡¶æ€æ¡ˆï¼Œå¬è¯´å…‹åŠ³ç‹„æ–¯æ‰¾åˆ°äº†å…ƒå‡¶ã€‚',
                specialContent: 'ä½ çœ‹äº†çœ‹èƒŒåŒ…é‡Œçš„ä¸œè¥¿ï¼Œä¸‹æ°´é“å›¾çº¸ä¸Šèµ«ç„¶æœ‰ä¸€æ¡ç”¨äºç»´ä¿®çš„çš„å°è·¯ï¼'
            },
            'wangweiguo-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'æ—¶é—´åˆ°äº†ï¼Œæ‰€æœ‰äººéƒ½æ²¡æœ‰æ‰¾åˆ°å…ƒå‡¶ã€‚ä½•éç¼–é€ äº†ä¸€ä¸ªæ•…äº‹ï¼Œè¯´ä½ æŠ¥å‘Šå°¸ä½“æ˜¯å› ä¸ºå¿ƒè™šï¼Œè®©å…‹åŠ³ç‹„æ–¯æŠŠä½ å¤„æ­»äº†ã€‚',
                specialContent: 'å®Œäº†ï¼Œå¥½åƒæ²¡æœ‰ä»€ä¹ˆå¯ä»¥æŒ‡å‘å‡¶æ€æ¡ˆæˆ–è€…è®©æ–½å·¥è¿è¾“é˜Ÿç»§ç»­å·¥ä½œçš„ä¸œè¥¿å‘¢ã€‚é‚£åªèƒ½å¯„å¸Œæœ›äºå…¶ä»–äººèƒ½æ‰¾åˆ°è¯æ®äº†ã€‚'
            },
            'wuzhizhe-success-herbs': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ åƒäº†äººå‚ï¼Œå¤§è¡¥ã€‚äºæ˜¯å‡­ç€ä¸€è…”å­¤å‹‡è·³ä¸‹äº†æ°´ï¼Œæ‘¸åˆ°ä¸€ä¸ªæœºå…³ï¼Œä¸Šé¢çš„å›¾æ¡ˆå’Œå¯¼å¸ˆæ‰‹è®°ä¸Šçš„ä¸€æ¨¡ä¸€æ ·ã€‚åŸæ¥è¿™é‡Œæœ‰ä¸€ä¸ªæš—å®¤ï¼Œé‡Œé¢è—ç€å…‹åŠ³ç‹„æ–¯å½“å¹´ä¸ºäº†çš‡ä½è°‹æ€äº†è‡ªå·±çš„å“¥å“¥çš„è¯ç‰©ã€‚ä½ æ¨æµ‹æ­»è€…ä¹Ÿæ˜¯æƒ³å»å¯»æ‰¾è¿™ä¸ªè¯æ®ï¼Œå› ä¸ºæ„å¤–é­é‡äº†ä¸å¹¸ã€‚',
                specialContent: 'è¿™äººå‚å¯æ˜¯å¾¡åŒ»ç»™çš„...ç¨‹å©´è¿™è€å¤´ï¼Œè™½ç„¶éƒ½è¯´æ˜¯ä»–å½“å¹´å‘Šå‘çš„å…¬å­™æµè‡¼ï¼ŒåŒ»æœ¯è¿˜æ˜¯æœ‰ä¸¤æŠŠåˆ·å­çš„ã€‚æ—¢ç„¶ä¸çŸ¥é“æ€ä¹ˆåŠï¼Œè¦ä¸å…ˆå°å°è¿™äººå‚å§ã€‚'
            },
            'wuzhizhe-success-blueprint': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'ä½ è®¤çœŸè¯»äº†ä¸‹æ°´é“çš„è®¾è®¡å›¾çº¸ï¼Œå’Œå»ºç­‘è®¾è®¡å›¾ä¸€æ¯”å¯¹ï¼Œå‘ç°äº†ä¸€ä¸ªæš—å®¤ã€‚åœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ªè¯ç‰©ï¼Œèµ«ç„¶å†™ç€å…‹åŠ³ç‹„æ–¯å½“å¹´ä¸ºäº†çš‡ä½è°‹æ€äº†è‡ªå·±çš„å“¥å“¥ã€‚ä½ æ¨æµ‹æ­»è€…ä¹Ÿæ˜¯æƒ³å»å¯»æ‰¾è¿™ä¸ªè¯æ®ï¼Œå› ä¸ºæ„å¤–é­é‡äº†ä¸å¹¸ã€‚',
                specialContent: 'ä½ è®¤çœŸè¯»äº†ä¸‹æ°´é“çš„è®¾è®¡å›¾çº¸ï¼Œå’Œå»ºç­‘è®¾è®¡å›¾ä¸€æ¯”å¯¹ï¼Œå‘ç°äº†ä¸€ä¸ªæš—å®¤ã€‚'
            },
            'wuzhizhe-failure': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'æ—¶é—´åˆ°äº†ï¼Œæ‰€æœ‰äººéƒ½æ²¡æœ‰æ‰¾åˆ°å…ƒå‡¶ã€‚ä½•éç¼–é€ äº†ä¸€ä¸ªæ•…äº‹ï¼Œè®©å…‹åŠ³ç‹„æ–¯æŠŠä½ å¤„æ­»äº†ã€‚',
                specialContent: 'å®Œäº†ï¼Œå¥½åƒæ²¡æœ‰ä»€ä¹ˆå¯ä»¥æŒ‡å‘å‡¶æ€æ¡ˆæˆ–è€…å¯ä»¥è§£é‡Šå¯¼å¸ˆæ‰‹è®°ä¸Šçš„ä¸œè¥¿å‘¢ã€‚ä¸çŸ¥é“å…¶ä»–äººçš„è¿›å±•å¦‚ä½•äº†ã€‚'
            },
            'general-failure-map': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'å¤±å»äº†åœ°å›¾çš„ä½ è¿·è·¯äº†ã€‚',
                specialContent: 'æ²¡äº†åœ°å›¾çš„ä½ å¤±å»äº†æ–¹å‘ã€‚'
            },
            'general-failure-dice': {
                title: 'ä½ å¤±è´¥äº†',
                content: 'æ•¢æŠŠå‘½è¿äº¤ç»™éª°å­ï¼Œä½ æ‰æ˜¯çœŸçš„ä½•éã€‚',
                specialContent: 'æ•¢æŠŠå‘½è¿äº¤ç»™éª°å­ï¼Œä½ æ‰æ˜¯çœŸçš„ä½•éã€‚'
            },
            'general-success-scratcher': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'å¤§å®¶éƒ½æ²¡æœ‰æ‰¾åˆ°å‡¶æ‰‹ï¼Œå…‹åŠ³ç‹„æ–¯å¬è¯´äº†å‹ƒç„¶å¤§æ€’ã€‚ä½ çœ‹äº†çœ‹ç—’ç—’æŒ ï¼Œå†³å®šå¾—æŒ äººå¤„ä¸”æŒ äººã€‚ä½ æŒ äº†æŒ ä»–ï¼Œä»–ç¬‘äº†ã€‚',
                specialContent: 'çœ‹çœ‹èƒŒåŒ…...è¿™æ—¶æ¥æç¬‘çš„å§ï¼Ÿç®—äº†åˆ°æ—¶å€™éšæœºåº”å˜å§ã€‚'
            },
            'general-success-primer': {
                title: 'ä½ æˆåŠŸäº†',
                content: 'éš”ç¦»éœœå‡ç™½ã€‚ä½ è¢«æ´—ç™½äº†ã€‚',
                specialContent: 'éš”ç¦»éœœæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä¸ç®¡äº†ï¼Œèƒ½ç”¨çš„éƒ½ç”¨ä¸€ç”¨å§ï¼Œå°±åƒè€ƒè¯•å“ªæ€•ä¸çŸ¥é“ç­”æ¡ˆä¹Ÿå¾—å¡«æ»¡å•Šã€‚ä½ æŠŠéš”ç¦»éœœæ¶‚åœ¨äº†è„¸ä¸Šã€‚'
            },
            'easter-egg-ascend': {
                title: 'ä½ ç™»åŸºäº†',
                content: 'æ—¢ç„¶é»„è¢æ˜¯çª—å¸˜å¸ƒï¼Œè¿™ä¸ªä¸–ç•Œæ˜¯ä¸ªè‰å°ç­å­å˜›ã€‚çœ‹ç€æ‰‹ä¸Šçš„æƒæ–ï¼Œä½ ç¦è‡³å¿ƒçµã€‚',
                specialContent: 'åŠå—çª—å¸˜...æ€»è§‰å¾—å¥½å¯ç–‘ã€‚ä½ æŸ¥äº†åŠå—çª—å¸˜å¸ƒçš„å‡ºå¤„ï¼Œä¸‡ä¸‡æ²¡æƒ³åˆ°å…‹åŠ³ç‹„æ–¯ç©¿çš„â€œé»„è¢â€ç«ŸçœŸæ˜¯çª—å¸˜å¸ƒã€‚'
            }
        };
        
        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            // è·å–å½“å‰ç»“å±€çš„å†…å®¹
            let contentText = '';
            if (endingId && endingContents[endingId]) {
                contentText = endingContents[endingId].specialContent;
            } else {
                // å¦‚æœæ²¡æœ‰ç»“å±€IDï¼Œæˆ–è€…ç»“å±€IDä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å†…å®¹
                contentText = 'ç»“å±€å†…å®¹åŠ è½½ä¸­...';
            }
            
            // æ›´æ–°é¡µé¢å†…å®¹
            document.getElementById('ending-content-text').textContent = contentText;
        }
        
        // è·³è½¬åˆ°ç»“ç®—é¡µé¢
        function goToSettlement() {
            window.location.href = `settlement.html?character=${currentCharacter}&endingId=${endingId}`;
        }
        
        // æ›´æ–°ä¿¡æ¯é¢æ¿ï¼ˆæ”¯æŒç§»åŠ¨ç«¯å’Œç”µè„‘ç«¯ï¼‰
        function updateInfoPanel() {
            const isMobile = window.innerWidth <= 768;
            
            // æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.style.display = (isMobile && gameState.gameStarted) ? 'flex' : 'none';
            }
            
            // ç”µè„‘ç«¯æŒ‰é’®æ˜¾ç¤º
            const desktopBtn = document.getElementById('desktop-info-btn');
            if (desktopBtn) {
                desktopBtn.style.display = (!isMobile && gameState.gameStarted) ? 'flex' : 'none';
            }
            
            if (!gameState.gameStarted) {
                hideMobileInfoPanel();
                return;
            }
            
            // æ›´æ–°ç”µè„‘ç«¯ä¾§è¾¹æ å†…å®¹ï¼Œä½†ä¸è‡ªåŠ¨æ˜¾ç¤º
            if (!isMobile) {
                updateDesktopSidebarContent();
                return;
            }
            
            // ç§»åŠ¨ç«¯æ˜¾ç¤ºé¢æ¿
            const char = window.characters[gameState.selectedCharacter];
            const panel = document.getElementById('mobile-info-panel');
            
            if (panel) {
                panel.innerHTML = `
                    <div class="character-info">
                        <strong>è§’è‰²ï¼š</strong>
                        <span>${char.name}</span><br>
                        <small style="color: #666;">${char.title}</small>
                    </div>
                    
                    <h4>ğŸ“¦ èƒŒåŒ…</h4>
                    <div id="mobile-inventory">
                        ${gameState.playerInventory.length === 0 ?
                            '<div style="color: #999; font-style: italic;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                            gameState.playerInventory.map(item =>
                                `<div style="padding: 8px; margin: 5px 0; background: #f5f5f5; border-radius: 5px;">${getItemDisplayName(item)}</div>`
                            ).join('')
                        }
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <strong>ç¬¬ ${gameState.currentDay} ç« </strong>
                    </div>
                `;
            }
        }
        
        // æ›´æ–°ç”µè„‘ç«¯ä¾§è¾¹æ å†…å®¹
        function updateDesktopSidebarContent() {
            const sidebar = document.getElementById('desktop-sidebar');
            const content = document.getElementById('desktop-sidebar-content');
            
            if (sidebar && content) {
                const char = window.characters[gameState.selectedCharacter];
                content.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>å½“å‰è§’è‰²ï¼š</strong><br>
                        <span style="color: #667eea; font-size: 16px;">${char.name}</span><br>
                        <small style="color: #666;">${char.title}</small>
                    </div>
                    
                    <h4 style="margin: 15px 0 10px 0; color: #667eea; font-size: 14px;">ğŸ“¦ èƒŒåŒ…</h4>
                    <div id="desktop-inventory">
                        ${gameState.playerInventory.length === 0 ?
                            '<div style="color: #999; font-style: italic; padding: 10px;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                            gameState.playerInventory.map(item =>
                                `<div style="padding: 8px; margin: 5px 0; background: #f8f9ff; border-radius: 5px; border-left: 3px solid #667eea;">${getItemDisplayName(item)}</div>`
                            ).join('')
                        }
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <strong>ç¬¬ ${gameState.currentDay} ç« </strong>
                    </div>
                `;
            }
        }
        
        // éšè—ç”µè„‘ç«¯ä¾§è¾¹æ 
        function hideDesktopSidebar() {
            const sidebar = document.getElementById('desktop-sidebar');
            if (sidebar) {
                sidebar.style.display = 'none';
            }
        }
        
        // åˆ‡æ¢ç”µè„‘ç«¯ä¾§è¾¹æ 
        function toggleDesktopSidebar() {
            const sidebar = document.getElementById('desktop-sidebar');
            if (sidebar) {
                const isVisible = sidebar.style.display === 'block';
                if (isVisible) {
                    sidebar.style.display = 'none';
                } else {
                    sidebar.style.display = 'block';
                }
            }
        }
        
        // éšè—ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function hideMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');
            
            if (panel && overlay) {
                panel.style.display = 'none';
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
        }
        
        // åˆ‡æ¢ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function toggleMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            if (panel) {
                const isVisible = panel.style.display === 'block';
                if (isVisible) {
                    hideMobileInfoPanel();
                } else {
                    const char = window.characters[gameState.selectedCharacter];
                    panel.innerHTML = `
                        <div class="character-info">
                            <strong>è§’è‰²ï¼š</strong>
                            <span>${char.name}</span><br>
                            <small style="color: #666;">${char.title}</small>
                        </div>
                        
                        <h4>ğŸ“¦ èƒŒåŒ…</h4>
                        <div id="mobile-inventory">
                            ${gameState.playerInventory.length === 0 ?
                                '<div style="color: #999; font-style: italic;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                                gameState.playerInventory.map(item =>
                                    `<div style="padding: 8px; margin: 5px 0; background: #f5f5f5; border-radius: 5px;">${getItemDisplayName(item)}</div>`
                                ).join('')
                            }
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                            <strong>ç¬¬ ${gameState.currentDay} ç« </strong>
                        </div>
                    `;
                    panel.style.display = 'block';
                    document.getElementById('mobile-overlay').style.display = 'block';
                    document.body.style.overflow = 'hidden';
                }
            }
        }
        
        // äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            initPage();
            updateInfoPanel();
            
            // ç§»åŠ¨ç«¯æŒ‰é’®äº‹ä»¶
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', toggleMobileInfoPanel);
            }
            
            // ç”µè„‘ç«¯æŒ‰é’®äº‹ä»¶
            const desktopBtn = document.getElementById('desktop-info-btn');
            if (desktopBtn) {
                desktopBtn.addEventListener('click', toggleDesktopSidebar);
            }
            
            // é®ç½©å±‚ç‚¹å‡»å…³é—­
            document.addEventListener('click', function(e) {
                if (e.target.id === 'mobile-overlay') {
                    hideMobileInfoPanel();
                }
            });
            
            // ESCé”®å…³é—­
            document.addEventListener('keydown', function(e) {
                if (e.keyCode === 27) {
                    hideMobileInfoPanel();
                    hideDesktopSidebar();
                }
            });
        });
    </script>
</body>
</html>