<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¼˜48 - å†…å¿ƒç‹¬ç™½</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯æŒ‰é’® -->
    <div id="mobile-info-btn" style="position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #667eea; color: white; border: none; font-size: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); z-index: 1000; cursor: pointer; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>

    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿ -->
    <div id="mobile-info-panel" style="display: none; position: fixed; bottom: 80px; right: 20px; width: 250px; max-height: 300px; background: rgba(255, 255, 255, 0.98); border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); z-index: 1000; padding: 15px; overflow-y: auto;">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€å¡«å…… -->
    </div>

    <!-- é®ç½©å±‚ -->
    <div id="mobile-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

    <!-- å†…å¿ƒç‹¬ç™½å†…å®¹åŒºåŸŸ -->
    <div id="inner-thoughts-content">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="assets/js/characters.js"></script>
    <script src="assets/js/items.js"></script>
    <script>
        // ä»URLå‚æ•°è·å–è§’è‰²ä¿¡æ¯
        const urlParams = new URLSearchParams(window.location.search);
        const selectedCharacter = urlParams.get('character') || 'claudius';

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            selectedCharacter: selectedCharacter,
            currentDay: 1,
            gameStarted: true,
            playerInventory: [],
            allCharactersItems: {},
            npcs: []
        };

        // å†…å¿ƒç‹¬ç™½å†…å®¹
        const innerThoughts = {
            "claudius": {
                title: "å…‹åŠ³ç‹„æ–¯çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "ä½•éè¿™å®¶ä¼™ï¼Œåˆåœ¨è€ä»€ä¹ˆèŠ±æ‹›ï¼Ÿ",
                    "ä»–è¯´çš„é‚£å‡ºæˆï¼Œä¼šä¸ä¼šå’Œå½“å¹´çš„ç§˜å¯†æœ‰å…³ï¼Ÿ",
                    "æˆ‘å¿…é¡»ç¡®ä¿æ²¡æœ‰äººå‘ç°æˆ‘çš„è¿‡å»...",
                    "çš‡å®«å¿…é¡»æŒ‰æ—¶å®Œå·¥ï¼Œè¿™æ˜¯æˆ‘æœ€åçš„æœºä¼šäº†ã€‚",
                    "å¸Œæœ›è¿™æ¬¡è°ƒæŸ¥èƒ½å¸®æˆ‘æ‰¾åˆ°é‚£ä»½è¯¥æ­»çš„è¯æ®ã€‚"
                ],
                emotion: "ç„¦è™‘"
            },
            "chengying": {
                title: "ç¨‹å©´çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "ç»ˆäºæœ‰æœºä¼šè°ƒæŸ¥é™›ä¸‹çš„ç—…å› äº†ã€‚",
                    "å½“å¹´é™›ä¸‹çš„çˆ¶äº²æ­»å¾—ä¸æ˜ä¸ç™½ï¼Œè¿™èƒŒåä¸€å®šæœ‰ç§˜å¯†ã€‚",
                    "ä½•éçš„åŠæ³•å¬èµ·æ¥å¾ˆå¯ç–‘ï¼Œæˆ‘å¾—å°å¿ƒè¡Œäº‹ã€‚",
                    "å¦‚æœèƒ½æ­å¼€çœŸç›¸ï¼Œæˆ–è®¸èƒ½ä¸ºå…ˆç‹æŠ¥ä»‡ã€‚",
                    "ä½†æˆ‘å¿…é¡»ä¿æŠ¤å¥½è‡ªå·±ï¼Œè€éª¨å¤´ä¸€æŠŠäº†ã€‚"
                ],
                emotion: "åšå®š"
            },
            "hefei": {
                title: "ä½•éçš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "å“¼å“¼ï¼Œæˆ‘çš„è®¡åˆ’å°±è¦å¼€å§‹äº†ã€‚",
                    "è¿™å¸®å®¶ä¼™è¿˜ä¸çŸ¥é“æˆ‘è¦ç©ä»€ä¹ˆæŠŠæˆã€‚",
                    "é’±æ˜¯æœ€é‡è¦çš„ï¼Œæˆ‘å¾—æƒ³åŠæ³•å¤šæç‚¹å¥½å¤„ã€‚",
                    "å…‹åŠ³ç‹„æ–¯é‚£å®¶ä¼™ï¼Œçœ‹èµ·æ¥å¾ˆç´§å¼ å•Šã€‚",
                    "è¿™åœºæˆä¸€å®šä¼šè®©ä»–ä»¬å¤§å¼€çœ¼ç•Œï¼"
                ],
                emotion: "å¾—æ„"
            },
            "lixiang": {
                title: "ææƒ³çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "è®¾è®¡å›¾æ˜¯æˆ‘äº²æ‰‹ç»˜åˆ¶çš„ï¼Œä¸å¯èƒ½æœ‰é—®é¢˜ã€‚",
                    "ä½†å¦‚æœå°¸ä½“çœŸçš„æ˜¯å› ä¸ºè®¾è®¡å¤±è¯¯é€ æˆçš„...",
                    "æˆ‘çš„èŒä¸šç”Ÿæ¶¯å°±å®Œäº†ã€‚",
                    "ä½•éçš„æˆåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ",
                    "æˆ‘å¾—èµ¶ç´§æ£€æŸ¥ä¸€ä¸‹è®¾è®¡å›¾çº¸ã€‚"
                ],
                emotion: "æ‹…å¿§"
            },
            "wuzhizhe": {
                title: "å´æ™ºå“²çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "å¸ˆå‚…ç•™ä¸‹çš„ç§˜å¯†ï¼Œç»ˆäºæœ‰æœºä¼šæ­å¼€äº†ã€‚",
                    "ä½•éè¯´çš„é‚£å‡ºæˆï¼Œä¼šä¸ä¼šå’Œå¸ˆå‚…æœ‰å…³ï¼Ÿ",
                    "æˆ‘å¿…é¡»ä¿æŠ¤å¥½é‚£äº›ç§˜å¯†ã€‚",
                    "ä½†å¥½å¥‡å¿ƒè®©æˆ‘å¿ä¸ä½æƒ³çŸ¥é“çœŸç›¸ã€‚",
                    "è¿™åœºè°ƒæŸ¥æˆ–è®¸èƒ½å¸®æˆ‘å®Œæˆå¸ˆå‚…çš„é—æ„¿ã€‚"
                ],
                emotion: "å¥½å¥‡"
            },
            "wangweiguo": {
                title: "ç‹å«å›½çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "çš‡å®«å¿…é¡»æŒ‰æ—¶å®Œå·¥ï¼Œè¿™æ˜¯æˆ‘çš„è´£ä»»ã€‚",
                    "ä½†ç°åœ¨å‡ºäº†äººå‘½æ¡ˆï¼Œè¿™å¯éº»çƒ¦äº†ã€‚",
                    "ä½•éçš„åŠæ³•å¬èµ·æ¥å¾ˆç„ä¹ã€‚",
                    "æˆ‘å¾—ç¡®ä¿å·¥äººä»¬çš„å®‰å…¨ã€‚",
                    "å¸Œæœ›è¿™æ¬¡è°ƒæŸ¥èƒ½å°½å¿«ç»“æŸã€‚"
                ],
                emotion: "è°¨æ…"
            }
        };

        // åˆå§‹åŒ–è§’è‰²æ•°æ®
        function initCharacterData() {
            const char = window.characters[selectedCharacter];
            gameState.playerInventory = [...char.initialItems];
            updateMobileInfoPanel();
            showInnerThoughts();
        }

        // æ˜¾ç¤ºå†…å¿ƒç‹¬ç™½
        function showInnerThoughts() {
            const thoughts = innerThoughts[selectedCharacter] || innerThoughts["claudius"];
            const char = window.characters[selectedCharacter];

            const html = `
                <div class="page-container">
                    <h2>${thoughts.title}</h2>

                    <div class="inner-thoughts-content">
                        <div class="character-header">
                            <div class="character-avatar">${char.name.charAt(0)}</div>
                            <div class="character-info">
                                <h3>${char.name} - ${char.title}</h3>
                                <div class="emotion-badge ${thoughts.emotion.toLowerCase()}">
                                    å½“å‰å¿ƒæƒ…ï¼š${thoughts.emotion}
                                </div>
                            </div>
                        </div>

                        <div class="thoughts-list">
                            ${thoughts.thoughts.map((thought, index) =>
                                `<div class="thought-item" style="animation-delay: ${index * 0.5}s">
                                    <div class="thought-bubble">
                                        <p>${thought}</p>
                                    </div>
                                </div>`
                            ).join('')}
                        </div>

                        <div class="thoughts-actions">
                            <button class="action-btn primary large" onclick="proceedToGame()">
                                å¼€å§‹è°ƒæŸ¥
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('inner-thoughts-content').innerHTML = html;
        }

        // ç»§ç»­åˆ°æ¸¸æˆ
        function proceedToGame() {
            // å°†è§’è‰²ä¿¡æ¯ä¼ é€’å›ä¸»æ¸¸æˆ
            const gameUrl = `game.html?character=${selectedCharacter}&day=1&from=inner-thoughts`;
            window.location.href = gameUrl;
        }

        // æ›´æ–°ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function updateMobileInfoPanel() {
            const isMobile = window.innerWidth <= 768;

            // æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.style.display = (isMobile && gameState.gameStarted) ? 'flex' : 'none';
            }

            if (!isMobile || !gameState.gameStarted) {
                hideMobileInfoPanel();
                return;
            }

            const char = window.characters[gameState.selectedCharacter];
            const panel = document.getElementById('mobile-info-panel');

            if (panel) {
                panel.innerHTML = `
                    <div class="character-info">
                        <strong>è§’è‰²ï¼š</strong>
                        <span>${char.name}</span><br>
                        <small style="color: #666;">${char.title}</small>
                    </div>

                    <h4>ğŸ“¦ èƒŒåŒ…</h4>
                    <div id="mobile-inventory">
                        ${gameState.playerInventory.length === 0 ?
                            '<div style="color: #999; font-style: italic;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                            gameState.playerInventory.map(item =>
                                `<div style="padding: 8px; margin: 5px 0; background: #f5f5f5; border-radius: 5px;">${item}</div>`
                            ).join('')
                        }
                    </div>

                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <strong>ç¬¬ ${gameState.currentDay} å¤©</strong>
                    </div>
                `;
            }
        }

        // åˆ‡æ¢ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function toggleMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            if (panel) {
                const isVisible = panel.style.display === 'block';
                if (isVisible) {
                    hideMobileInfoPanel();
                } else {
                    showMobileInfoPanel();
                }
            }
        }

        // æ˜¾ç¤ºç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function showMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'block';
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        // éšè—ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function hideMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'none';
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            initCharacterData();

            // ç§»åŠ¨ç«¯æŒ‰é’®äº‹ä»¶
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', toggleMobileInfoPanel);
            }

            // é®ç½©å±‚ç‚¹å‡»å…³é—­
            document.addEventListener('click', function(e) {
                if (e.target.id === 'mobile-overlay') {
                    hideMobileInfoPanel();
                }
            });

            // ESCé”®å…³é—­
            document.addEventListener('keydown', function(e) {
                if (e.keyCode === 27) {
                    hideMobileInfoPanel();
                }
            });
        });
    </script>
</body>
</html>