<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¼˜48 - å†…å¿ƒç‹¬ç™½</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯æŒ‰é’® -->
    <div id="mobile-info-btn" style="position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #667eea; color: white; border: none; font-size: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); z-index: 1000; cursor: pointer; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>

    <!-- ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿ -->
    <div id="mobile-info-panel" style="display: none; position: fixed; bottom: 80px; right: 20px; width: 250px; max-height: 300px; background: rgba(255, 255, 255, 0.98); border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); z-index: 1000; padding: 15px; overflow-y: auto;">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€å¡«å…… -->
    </div>

    <!-- é®ç½©å±‚ -->
    <div id="mobile-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

    <!-- å†…å¿ƒç‹¬ç™½å†…å®¹åŒºåŸŸ -->
    <div id="inner-thoughts-content">
        <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="assets/js/characters.js"></script>
    <script src="assets/js/items.js"></script>
    <script src="assets/js/itemStories.js"></script>
    <script src="assets/js/backpack-improvements.js"></script>
    <script src="assets/js/item-details.js"></script>
    <script>
        // ä»URLå‚æ•°è·å–è§’è‰²ä¿¡æ¯
        const urlParams = new URLSearchParams(window.location.search);
        const selectedCharacter = urlParams.get('character') || 'claudius';

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            selectedCharacter: selectedCharacter,
            currentDay: 1,
            gameStarted: true,
            playerInventory: [],
            allCharactersItems: {},
            npcs: []
        };

        // å†…å¿ƒç‹¬ç™½å†…å®¹
        const innerThoughts = {
            "claudius": {
                title: "å…‹åŠ³ç‹„æ–¯çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "ä½•éè¿™å®¶ä¼™ï¼Œåˆ°åº•å¯ä¸å¯ä¿¡ï¼Ÿ",
                    "ä»–è¯´çš„é‚£å‡ºæˆï¼Œåˆ«å¸¦å‡ºäº†å½“å¹´çš„ç§˜å¯†ã€‚",
                    "å¸Œæœ›è¿™æ¬¡è°ƒæŸ¥èƒ½å¸®æˆ‘æ‰¾åˆ°é‚£ä»½è¯¥æ­»çš„è¯æ®ã€‚",
                    "çš‡å®«é‡Œåˆ°å¤„éƒ½ç¿»éäº†ï¼Œå°±å‰©ä¸‹è¿™å‡ ä¸ªäººè¿˜æ²¡æœ‰æ¢è¿‡äº†ã€‚",
                    "ä»å“ªé‡Œå¼€å§‹æ¯”è¾ƒå¥½å‘¢ï¼Ÿ"
                ]
            },
            "chengying": {
                title: "ç¨‹å©´çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "ç»ˆäºæœ‰æœºä¼šè°ƒæŸ¥å…ˆç‹çš„æ­»å› äº†ã€‚äººäººéƒ½è¯´æˆ‘å¿ƒç‹ æ‰‹è¾£å¼„æ­»äº†å…¬å­™æµè‡¼ï¼Œå…¶å®è¿˜ç•™åœ¨è¿™çš‡å®«æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Œåªæœ‰æˆ‘è‡ªå·±çŸ¥é“ã€‚",
                    "ä½•éçš„åŠæ³•å¬èµ·æ¥å¾ˆå¯ç–‘ï¼Œæˆ‘å¾—å°å¿ƒè¡Œäº‹ã€‚",
                    "å¦‚æœèƒ½æ­å¼€çœŸç›¸ï¼Œæˆ–è®¸èƒ½ä¸ºå…ˆç‹æŠ¥ä»‡ã€‚",
                    "è€éª¨å¤´ä¸€æŠŠäº†ï¼Œä¹Ÿå°±å¿ƒå£è¿™ç‚¹è¡€è¿˜æ¸©çƒ­ç€ã€‚",
                    "ä¸è¡Œï¼Œæˆ‘å¾—æƒ³åŠæ³•æ‰¾äººæ¢ç‚¹æ¶ˆæ¯ã€‚"
                ]
            },
            "hefei": {
                title: "ä½•éçš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "èµŒå€ºçš„æœŸé™é©¬ä¸Šå°±è¦åˆ°äº†ï¼Œæ²¡åŠæ³•åªèƒ½æœ€åä¸€æäº†ã€‚",
                    "å…¶å®æˆ‘å“ªçŸ¥é“ä»€ä¹ˆå‡¶æ€æ¡ˆï¼Œåªèƒ½æƒ³åŠæ³•è¯ˆä¸€ä¸‹ã€‚",
                    "è¿™å‡ ä¸ªäººèƒ½æ··åˆ°è¿™é‡Œï¼Œä¸€ä¸ªä¸ªçš„éƒ½æ˜¯äººç²¾ã€‚",
                    "ä¸è¡Œï¼Œè¿˜æ˜¯å¾—æƒ³åŠæ³•æ¢ç‚¹æƒ…æŠ¥å•Šã€‚",
                    "ä»å“ªé‡Œä¸‹æ‰‹æ¯”è¾ƒå¥½å‘¢ï¼Ÿ"
                ]
            },
            "lixiang": {
                title: "ææƒ³çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "çš‡å®«çš„ä¸‹æ°´é“è®¾è®¡å’Œå½“å¹´æ–°åŸå»ºè®¾ä¸€æ ·ï¼Œæ˜¯æˆ‘äº²æ‰‹ç»˜åˆ¶çš„ã€‚",
                    "æ±›æœŸé›¨å­£éƒ½è€ƒè™‘äº†ï¼Œç»ä¸å¯èƒ½æœ‰é—®é¢˜ã€‚",
                    "ä¸€å®šæ˜¯æœ‰äººè¦æ ½èµƒé™·å®³æˆ‘ã€‚",
                    "ä½†æ˜¯ä½•éçš„æˆåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ",
                    "æˆ‘å¾—æƒ³åŠæ³•çœ‹çœ‹è°èƒ½æä¾›ç‚¹æ¶ˆæ¯ã€‚"
                ]
            },
            "wuzhizhe": {
                title: "å´æ™ºå“²çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "å¸ˆå‚…æ‰‹è®°ä¸Šçš„æ°´æµå›¾æ¡ˆåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ",
                    "ä½•éè¯´çš„é‚£å‡ºæˆåˆæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ",
                    "çš‡å®«é‡Œçš„æ°´æµï¼Œé™¤äº†å¾¡è†³æˆ¿å’Œå•æ‰€è¿™äº›æ˜é¢ä¸Šæœ‰æ°´çš„åœ°æ–¹ï¼Œæ˜¯ä¸æ˜¯åªæœ‰ä¸‹æ°´é“äº†ã€‚",
                    "ä¸€ç›´æ²¡ä»€ä¹ˆæœºä¼šè¿›å®«ï¼Œä»Šå¤©ç»ˆäºæœ‰æœºä¼šæ¢å¯»ä¸€ä¸‹ã€‚",
                    "ä¹Ÿä¸çŸ¥é“æœ‰æ²¡æœ‰äººæ„¿æ„æä¾›ç‚¹æ¶ˆæ¯ã€‚"
                ]
            },
            "wangweiguo": {
                title: "ç‹å«å›½çš„å†…å¿ƒç‹¬ç™½",
                thoughts: [
                    "çœŸæ˜¯å¤ªä¸å¹¸ï¼Œç¥¸æ®ƒåŠè€ç™¾å§“ã€‚",
                    "æˆ‘å°±æ˜¯ä¸ªæ™®æ™®é€šé€šçš„è¿è¾“é˜Ÿé•¿ï¼Œæ€ä¹ˆå°±å·è¿›å‡¶æ€æ¡ˆé‡Œäº†ã€‚",
                    "å…„å¼Ÿä»¬è¿˜ç­‰ç€èµ¶ç´§å®Œå·¥å›å®¶è¿‡å¹´å‘¢ã€‚",
                    "ä½†æ˜¯å…³é”®é“è·¯å°é”äº†ï¼Œæ–½å·¥ä¹Ÿè¢«è¿«åœäº†ã€‚",
                    "æˆ‘æœ‰åŠæ³•æ¨è¿›æ¡ˆä»¶è¿›ç¨‹å—ï¼Ÿ",
                    "è¿˜æ˜¯å…ˆæƒ³åŠæ³•è®©æˆ‘ä»¬çš„æ–½å·¥è¿›è¡Œä¸‹å»ï¼Ÿ"
                ]
            }
        };

        // åˆå§‹åŒ–è§’è‰²æ•°æ®
        function initCharacterData() {
            const char = window.characters[selectedCharacter];
            gameState.playerInventory = [...char.initialItems];
            updateMobileInfoPanel();
            showInnerThoughts();
        }

        // æ˜¾ç¤ºå†…å¿ƒç‹¬ç™½
        function showInnerThoughts() {
            const thoughts = innerThoughts[selectedCharacter] || innerThoughts["claudius"];
            const char = window.characters[selectedCharacter];

            const html = `
                <div class="page-container">
                    <h2>${thoughts.title}</h2>

                    <div class="inner-thoughts-content">
                        <div class="character-header">
                            <div class="character-avatar">${char.name.charAt(0)}</div>
                            <div class="character-info">
                                <h3>${char.name} - ${char.title}</h3>
                            </div>
                        </div>

                        <div class="thoughts-list">
                            ${thoughts.thoughts.map((thought, index) =>
                                `<div class="thought-item" style="animation-delay: ${index * 0.5}s">
                                    <div class="thought-bubble">
                                        <p>${thought}</p>
                                    </div>
                                </div>`
                            ).join('')}
                        </div>

                        <div class="thoughts-actions">
                            <button class="action-btn primary large" onclick="proceedToGame()">
                                å¼€å§‹è°ƒæŸ¥
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('inner-thoughts-content').innerHTML = html;
        }

        // ç»§ç»­åˆ°é€‰æ‹©äº¤æ¢å¯¹è±¡
        function proceedToGame() {
            // è·³è½¬åˆ°é€‰æ‹©äº¤æ¢å¯¹è±¡çš„é¡µé¢
            const selectUrl = `select-exchange-target.html?character=${selectedCharacter}&day=1`;
            window.location.href = selectUrl;
        }

        // æ›´æ–°ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function updateMobileInfoPanel() {
            const isMobile = window.innerWidth <= 768;

            // æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.style.display = (isMobile && gameState.gameStarted) ? 'flex' : 'none';
            }

            if (!isMobile || !gameState.gameStarted) {
                hideMobileInfoPanel();
                return;
            }

            const char = window.characters[gameState.selectedCharacter];
            const panel = document.getElementById('mobile-info-panel');

            if (panel) {
                panel.innerHTML = `
                    <div class="character-info">
                        <strong>è§’è‰²ï¼š</strong>
                        <span>${char.name}</span><br>
                        <small style="color: #666;">${char.title}</small>
                    </div>

                    <h4>ğŸ“¦ èƒŒåŒ…</h4>
                    <div id="mobile-inventory">
                        ${gameState.playerInventory.length === 0 ?
                            '<div style="color: #999; font-style: italic;">èƒŒåŒ…æ˜¯ç©ºçš„</div>' :
                            gameState.playerInventory.map(item =>
                                `<div style="padding: 8px; margin: 5px 0; background: #f5f5f5; border-radius: 5px;">${getItemDisplayName(item)}</div>`
                            ).join('')
                        }
                    </div>

                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <strong>ç¬¬ ${gameState.currentDay} ç« </strong>
                    </div>
                `;
            }
        }

        // åˆ‡æ¢ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function toggleMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            if (panel) {
                const isVisible = panel.style.display === 'block';
                if (isVisible) {
                    hideMobileInfoPanel();
                } else {
                    showMobileInfoPanel();
                }
            }
        }

        // æ˜¾ç¤ºç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function showMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'block';
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        // éšè—ç§»åŠ¨ç«¯ä¿¡æ¯é¢æ¿
        function hideMobileInfoPanel() {
            const panel = document.getElementById('mobile-info-panel');
            const overlay = document.getElementById('mobile-overlay');

            if (panel && overlay) {
                panel.style.display = 'none';
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            initCharacterData();

            // ç§»åŠ¨ç«¯æŒ‰é’®äº‹ä»¶
            const mobileBtn = document.getElementById('mobile-info-btn');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', toggleMobileInfoPanel);
            }

            // é®ç½©å±‚ç‚¹å‡»å…³é—­
            document.addEventListener('click', function(e) {
                if (e.target.id === 'mobile-overlay') {
                    hideMobileInfoPanel();
                }
            });

            // ESCé”®å…³é—­
            document.addEventListener('keydown', function(e) {
                if (e.keyCode === 27) {
                    hideMobileInfoPanel();
                }
            });
        });
    </script>
</body>
</html>